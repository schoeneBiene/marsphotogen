apikey = ''
import random
import json
import requests
import time
# from PIL import Image
import os
from sys import argv
# from matplotlib import pyplot as plt
# from matplotlib import image as mpimg




# response = '{"photos":[{"id":418538,"sol":1083,"camera":{"id":22,"name":"MAST","rover_id":5,"full_name":"Mast Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mcam/1083ML0047640000206924I01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":418539,"sol":1083,"camera":{"id":22,"name":"MAST","rover_id":5,"full_name":"Mast Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mcam/1083MR0047630000600365I01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":418540,"sol":1083,"camera":{"id":22,"name":"MAST","rover_id":5,"full_name":"Mast Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mcam/1083MR0047620000600364I01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411017,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ccam/CR0_493635670EDR_F0491216CCAM04082M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411018,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ccam/CR0_493635041EDR_F0491216CCAM04082M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411019,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ccam/CR0_493634925EDR_F0491216CCAM03082M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411020,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ccam/CR0_493633718EDR_F0491216CCAM03082M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411021,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493635670PRC_F0491216CCAM04082L1.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411022,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493635041PRC_F0491216CCAM04082L1.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411023,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493635041PRC_F0491216CCAM04082L2.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411024,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493634925PRC_F0491216CCAM03082L1.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411025,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493634925PRC_F0491216CCAM03082L2.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411026,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493633718PRC_F0491216CCAM03082L2.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":411027,"sol":1083,"camera":{"id":23,"name":"CHEMCAM","rover_id":5,"full_name":"Chemistry and Camera Complex"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/soas/rdr/ccam/CR0_493633718PRC_F0491216CCAM03082L1.PNG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":414336,"sol":1083,"camera":{"id":24,"name":"MAHLI","rover_id":5,"full_name":"Mars Hand Lens Imager"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mhli/1083MH0003250050400798E01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":414337,"sol":1083,"camera":{"id":24,"name":"MAHLI","rover_id":5,"full_name":"Mars Hand Lens Imager"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mhli/1083MH0003250050400798I01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":413350,"sol":1083,"camera":{"id":25,"name":"MARDI","rover_id":5,"full_name":"Mars Descent Imager"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mrdi/1083MD0004120000103725E01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":413351,"sol":1083,"camera":{"id":25,"name":"MARDI","rover_id":5,"full_name":"Mars Descent Imager"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/msss/01083/mrdi/1083MD0004120000103725I01_DXXX.jpg","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406724,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646958EDR_F0491420NCAM00252M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406725,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646927EDR_F0491420NCAM00252M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406726,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646896EDR_F0491420NCAM00252M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406727,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646812EDR_F0491420NCAM00252M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406728,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646782EDR_F0491420NCAM00252M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406729,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646749EDR_F0491420NCAM00354M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}},{"id":406730,"sol":1083,"camera":{"id":26,"name":"NAVCAM","rover_id":5,"full_name":"Navigation Camera"},"img_src":"http://mars.jpl.nasa.gov/msl-raw-images/proj/msl/redops/ods/surface/sol/01083/opgs/edr/ncam/NLB_493646718EDR_F0491420NCAM00354M_.JPG","earth_date":"2015-08-23","rover":{"id":5,"name":"Curiosity","landing_date":"2012-08-06","launch_date":"2011-11-26","status":"active"}}]}'

with open("./api.key", "r") as f:
    apikey = f.read()
    
    print("Using API key: " + apikey)

print("""

 /$$      /$$                               /$$$$$$$  /$$                   /$$                          /$$$$$$                     
| $$$    /$$$                              | $$__  $$| $$                  | $$                         /$$__  $$                    
| $$$$  /$$$$  /$$$$$$   /$$$$$$   /$$$$$$$| $$  \ $$| $$$$$$$   /$$$$$$  /$$$$$$    /$$$$$$   /$$$$$$$| $$  \__/  /$$$$$$  /$$$$$$$ 
| $$ $$/$$ $$ |____  $$ /$$__  $$ /$$_____/| $$$$$$$/| $$__  $$ /$$__  $$|_  $$_/   /$$__  $$ /$$_____/| $$ /$$$$ /$$__  $$| $$__  $$
| $$  $$$| $$  /$$$$$$$| $$  \__/|  $$$$$$ | $$____/ | $$  \ $$| $$  \ $$  | $$    | $$  \ $$|  $$$$$$ | $$|_  $$| $$$$$$$$| $$  \ $$
| $$\  $ | $$ /$$__  $$| $$       \____  $$| $$      | $$  | $$| $$  | $$  | $$ /$$| $$  | $$ \____  $$| $$  \ $$| $$_____/| $$  | $$
| $$ \/  | $$|  $$$$$$$| $$       /$$$$$$$/| $$      | $$  | $$|  $$$$$$/  |  $$$$/|  $$$$$$/ /$$$$$$$/|  $$$$$$/|  $$$$$$$| $$  | $$
|__/     |__/ \_______/|__/      |_______/ |__/      |__/  |__/ \______/    \___/   \______/ |_______/  \______/  \_______/|__/  |__/
                                                                                                                                     
                                                                                                                                     
                                                                                                                                     

""")

def getImg():
    page = random.randint(1,2)
    sol = random.randint(0,100)
    data = {"page": page, "sol":sol, "api_key":apikey}
    print(data)
    time.sleep(3)
    response = requests.get('https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos',params=data)
    print(response)
    r = json.loads(response.text)
    r = r['photos']
    print(len(r))
    # print(r)
    r = r[random.randint(1,3)]
    img_src = r['img_src']
    img_data = requests.get(img_src)
    with open(os.path.join(os.getcwd(), str(r['id'])), "xb") as f:
        f.write(img_data.content)
    

    print("Saved as " + str(r['id']))
getImg()